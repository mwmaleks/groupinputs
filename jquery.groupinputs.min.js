/**
 * GroupInputs v. 0.8.3
 * @author Pavel Kornilov <pk@ostrovok.ru> <lusever@lusever.com>
 * https://github.com/lusever/groupinputs
 * MIT Licensed
 */
(function(e){"use strict";function r(e,t,n){var r,i;if(t!==undefined){if(e.setSelectionRange){e.setSelectionRange(t,n)}else if(document.selection&&document.selection.createRange){r=e.createTextRange();r.collapse(true);r.moveEnd("character",n);r.moveStart("character",t);r.select()}return}t=0;n=0;if("selectionStart"in e){t=e.selectionStart;n=e.selectionEnd}else if(e.createTextRange){r=document.selection.createRange();i=r.duplicate();if(r.parentElement()===e){t=-i.moveStart("character",-1e5);n=t+r.text.length}}return{start:t,end:n}}var t=!!window.opera,n="maxlength";e.fn.groupinputs=function(){function u(e,t){var n=f(e[0].value),o=r(e[0]).end,u=n.slice(0,o),a=n.slice(o),l=t.maxlength-a.length,c=false,h,p,d;for(d=i.length-1;d>t.index;d--){l+=s[d]-i[d].value.length}if(u.length>l){u=u.slice(0,l);p=l}else{p=o}if(n.length>t.maxlength){e[0].value=(u+a).slice(0,t.maxlength);if(p<=t.maxlength){r(e[0],p,p);c=true}h=(u+a).slice(t.maxlength);if(h.length){p-=Math.min(t.maxlength,u.length);var v,m;while(i[++d]){v=s[d];h+=i[d].value;i.eq(d).val(h.slice(0,v)).change();if(h.length<=v){break}m=i[d].value.length;if(!c){if(p<v){c=true;i.eq(d).focus();r(i[d],p,p)}p-=m}h=h.slice(v)}}if(!c){i.eq(d).focus();r(i[d],p,p)}}}function a(e){var s=e.type,a=e.data,f=e.data.elem,l=e.data.index,c;if(t){if(s==="keypress"){s="keydown"}}var h=37,p=8,d=46,v=39;if(s==="keydown"&&e.keyCode===v){c=r(f[0]);if(c.start===this.value.length&&l!==i.length-1){i.eq(l+1).focus();r(i[l+1],0,0);e.preventDefault()}}if(s==="keydown"&&(e.keyCode===p||e.keyCode===h)){c=r(f[0]);if(c.start===c.end&&c.start===0&&l!==0){var m=i.eq(l-1),g=m.val().length;m.focus();r(m[0],g,g);if(e.keyCode===h){e.preventDefault()}}}if(s==="keyup"||s==="keydown"){if(e.keyCode<48){return}if(s==="keyup"&&a.ignoreNextKeyup){a.ignoreNextKeyup=false;return}if(e.metaKey){a.ignoreNextKeyup=true;return}c=r(f[0]);if(c.start===c.end&&c.start===this.value.length&&l!==i.length-1&&this.value.length===a.maxlength){i.eq(l+1).focus();r(i[l+1],0,0)}}if(s==="paste"){f.attr(n,o)}if(s==="propertychange"||s==="input"){if(f.attr(n)!==a.maxlength){setTimeout(function(){u(f,a);f.attr(n,a.maxlength)},0)}}if(s==="input"&&t){u(f,a)}}function f(e){e=e.replace(/\s+/g,"");e=e.replace(/\-/g,"");return e}if(/iPad|iPhone/.test(navigator.platform)){return this}var i=this,s=[],o=0;i.each(function(t){var r=i.eq(t),u=+r.attr(n);o+=u;s.push(u);r.bind("keydown keypress keyup input paste propertychange",function(n){n.data={elem:r,index:t,maxlength:u};var i=e(r).get(0);a.apply(i,[n])})});if(t){i.attr(n,o)}return i}})(jQuery)